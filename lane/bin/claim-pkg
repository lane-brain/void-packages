#!/usr/bin/env ion
# This is a script that symlinks a package to go into lane-pkgs
# This command is meant to be run from XBPS_DISTDIR

# functions

# Convenient local variable for env $XBPS_DISTDIR
let XBPSDIR = $XBPS_DISTDIR

fn check_xbpssrc
    let XBPS_SRC = $XBPSDIR/xbps-src
    if not exists -f $XBPS_SRC
        echo "No xbps-src found in path."
        exit 1
    end
end

# checks if path exists, if so returns path of file. exits with 1 if not
fn is_file path
    if exists -f $path
        echo $path
    else
        echo "$path isn't a file."
        exit 1
    end
end

fn srcpkg_path pkg
    is_file $XBPSDIR/srcpkgs/$pkg/template
end

fn cat_file path
    cat $(is_file $path)
end     

fn edit_file path
    $VISUAL $(is_file $path)
end

fn cat_srcpkg pkg
    cat_file $(srcpkg_path $pkg)
end

fn echo_srcpkg_attr attr pkg
    let file = $(srcpkg_path $pkg)
    let found = "false"
    for line in @lines($(cat $file))
        starts-with $attr && echo $line
        break
    end
end

if test $len(@args) -eq 1
    echo "Welcome! So far you've implemented the '-git' keyword."
    echo "Otherwise just a path will do."
    exit
end

# First we need to parse the input for the 'git' keyword and split up pkg paths
let keywords = [ls git edit]
let paths = []

for arg in @args
    for word in @args
        if test $word is 'git'
        
        
        


cd $XBPS_DISTDIR/lane/srcpkgs/
